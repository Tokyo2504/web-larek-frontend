# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```
## Архитектура
Приложение реализовано с помощью MVP архитектуры.

## Базовые классы
 ### 1. Класс ```Model```

Абстрактный класс, предназначенный для реализации работы с данными в различных моделях.

**Свойства:**
- ```data```: хранит данные объекта.
- ```events```: хранит объект для работы с событиями.

**Методы:**
- ```emitChanges```: уведомляет об изменении состояния модели.

### 2. Класс ```Component```

Абстрактный класс, предоставляющий базовые методы для работы с DOM-элементами и управления их состоянием.

**Свойства:**
- ```container```: контейнер, в котором размещается компонент.
- ```events```: объект, реализующий интерфейс для работы с событиями.

**Методы:**
- ```toggleClass```: добавляет или удаляет CSS-класс указанного элемента.
- ```setText```: устанавливает текстовое содержимое элемента.
- ```setDisabled```: добавляет или удаляет атрибут disabled.
- ```setHidden```: скрывает элемент, устанавливая ```display = none```.
- ```setVisible```: показывает элемент, изменяя его тип видимости с ```display = none```.
- ```setImage```: добавляет изображение в элемент ```img``` и изменяет его атрибуты ```src``` и ```alt```.
- ```render```: рендер компонента в виде DOM-элемента.

### 3. Класс ```Api```

Класс представляет собой обертку для взаимодействия с API, предоставляет методы для выполнения HTTP-запросов и обрабатывает ответы от сервера.

**Свойства:**
- ```baseUrl```: базовый URL для работы с API.
- ```options```: объект с настройками для HTTP-запроса.

**Методы:**
- ```handleResponse```: обрабатывает ответ от API, преобразует и возвращает его.
- ```get```: выполняет GET-запрос по указанному URL.
- ```post```: выполняет POST-запрос по указанному URL.

### 4. Класс ```EventEmitter```

Класс позволяет подписываться на события и уведомлять подписчиков о наступлении события.

**Свойства:**
- ```events```: хранит события и их подписчиков.

**Методы:**
- ```off```: снимает обработчки с события.
- ```onAll```: слушает все события.
- ```offAll```: сбрасывает все обработчики.

## Модели данных
### 1. Класс ```Product```

Класс наследуюется от базового класса ```Model``` и используется для хранения и управления данными товара.

**Свойства:**
- ```id```: идентификатор товара.
- ```description```: описание товара.
- ```image```: изображение товара.
- ```title```: название товара.
- ```category```: категория товара.
- ```price```: цена товара.

**Методы:**
В качестве методов используются сеттеры и геттеры.

### 2. Класс ```AppData```

Класс наследуюется от базового класса ```Model``` и управляет состоянием приложения.

**Свойства:**
- ```catalog```: мссив товаров в каталоге.
- ```basketItems```: массив товаров в корзине.
- ```order```: объект текущего заказа.
- ```preview```: просмотр выбранного товара.
- ```formErrors```: объект с ошибками валидации.

**Методы:**
- ```calculateTotal```: вычисляет общую сумму товаров в корзине.
- ```clearBasket```: очищает корзину.
- ```setCatalog```: устанавливает каталог товаров.
- ```setPreview```: устанавливает предварительный просмотр товара.
- ```listBasketItemIds```: возвращает список ID товаров в корзине.
- ```countBasketItems```: возвращает количество товаров в корзине.
- ```addToBasket```: добавляет товар в корзину.
- ```removeFromBasket```: удаляет товар из корзины по ID.
- ```updateProductInBasketState```: обновляет состояние товаров в корзине.
- ```updateBasket```: отвечает за уведомление других частей приложения о произошедших изменениях в корзине.
- ```updateOrder```: обновляет текущий заказ на основе содержимого корзины и уведомляет другие части приложения о произошедших изменениях в заказе.
- ```resetOrder```: очищает текущий заказ.
- ```setOrderField```: обновляет указанные поля заказа и, при необходимости, инициирует валидацию формы доставки.
- ```setContactsField```: обновляет указанные поля заказа и, при необходимости, инициирует валидацию формы контактов.
- ```validateOrder```: проверяет корректность данных формы доставки.
- ```validateContacts```: проверяет корректность данных формы контактов.
- ```validateFieldWithRegex```: выполняет валидацию значения поля на основе регулярного выражения и обновляет список ошибок формы, если значение не соответствует заданным условиям.
- ```validateField```: отвечает за простую валидацию поля, проверяя наличие значения и устанавливая сообщение об ошибке, если значение отсутствует.
- ```validateFieldError```: отвечает за добавление или удаление ошибки для конкретного поля формы в объекте ошибок.
- ```resetContacts```: выполняет сброс контактных данных пользователя.
- ```resetFormErrors```: отвечает за сброс всех ошибок формы.

## Классы отображения
### 1. Класс ```Page```

Класс отвечает за отображение всей страницы.

**Свойства:**
- ```catalog```: элемент, представляющий каталог товаров.
- ```counter```: элемент, отображающий счетчик количества товаров в корзине.
- ```wrapper```: контейнер для основного содержимого страницы.
- ```basket```: элемент, представляющий корзину.

**Методы:**
- ```counter```: обновляет значение счетчика на странице.
- ```catalog```: обновляет содержимое каталога.
- ```locked```: управляет состоянием блокировки страницы.
- ```addBasketClickListener```: добавляет обработчик события на элемент корзины и инициирует событие, когда на этот элемент кликает пользователь..

### 2. Класс ```ProductView```

Класс отвечает за отображение данных продукта.

**Свойства:**
- ```id```: элемент, представляющий идентификатор продукта.
- ```description```: элемент для отображения описания продукта.
- ```image```: изображения продукта.
- ```title```: элемент, отображающий название продукта.
- ```category```: элемент для отображения категории продукта.
- ```price```: элемент для отображения цены продукта.
- ```button```: кнопка продукта.

**Методы:**
- сеттеры.
- ```handleButtonClick```: отвечает за добавление обработчика события клика на кнопку (или другой элемент), в зависимости от переданных действий.
- ```setButtonText```: отвечает за изменение текста кнопки.
- ```setButtonState```: отвечает за изменение состояния кнопки.


### 3. Класс ```Basket```

Класс отвечает за отображение корзины товаров.

**Свойства:**
- ```list```: элемент для отображения списка товаров в корзине.
- ```total```: элемент для отображения общей суммы товаров в корзине.
- ```button```: кнопка для выполнения действий в корзине.

**Методы:**
- сеттеры.
- ```triggerOrderOpen```: отвечает за обработку клика по кнопке, который приводит к срабатыванию события.
- ```setButtonState```: управление доступностью кнопки в зависимости от того, выбраны элементы или нет.

### 4. Класс ```BasketItem```

Класс отвечает за отображение элемента в корзине.

**Свойства:**
- ```title```: элемент, который отображает название товара.
- ```index```: элемент, который отображает индекс (порядковый номер) товара в корзине.
- ```price```: элемент, который отображает цену товара.
- ```removeButton```: кнопка удаления товара из корзины.

**Методы:**
- сеттеры.
- ```setItemPosition```: устанавливает позицию товара в корзине.

### 5. Класс ```Form```

Класс представляет собой отображение формы.

**Свойства:**
- ```submit```: кнопка отправки формы.
- ```errors```: элемент для отображения ошибок в форме.

**Методы:**
- сеттеры.
- ```render```: рендерит форму.
- ```onInputChange```: обрабатывает изменение значений в поле формы.

### 6. Класс ```ContactsForm```

Класс отвечает за отображение формы контактной информации.

**Методы:**
- сеттеры.
- ```getInputItem```: получает элемент ввода по имени из контейнера формы.

### 7. Класс ```Delivery```

Класс отвечает за отображение и управление формой для ввода данных о способе платежа и адресе.

**Свойства:**
- ```buttons```: кнопки для выбора типа оплаты.
- ```container```: контейнер кнопок оплаты.

**Методы:**
- сеттеры.
- ```set address```: устанавливает адрес доставки в форму.
- ```setActivePayment```: делает активной кнопку, соответствующую выбранному методу оплаты.
- ```handlePaymentClick```: обрабатывает клики на кнопки выбора метода оплаты.
- ```attachPaymentBtnListeners```: добавляет обработчики событий для кнопок, связанных с оплатой.

### 8. Класс ```Modal```

Класс предназначен для управления модальными окнами.

**Свойства:**
- ```content```: элемент, представляющий содержимое модального окна.
- ```button```: кнопка управления модальным окном.

**Методы:**
- ```open```: открывает модальное окно.
- ```close```: закрывает модальное окно.
- ```setContent```: устанавливает содержимое модального окна.
- ```render```: рендерит модальное окно на странице.

### 9. Класс ```Success```

Класс отображает успешное завершение оформления заказа.

**Свойства:**
- ```total```: элемент, который отображает общую сумму покупки.
- ```closeButton```: кнопка для подтверждения оформления заказа и закрытия окна.

**Методы:**
- сеттер.
- ```updateTotal```: обновляет текстовое содержимое элемента, отображающего общую сумму.
- ```attachBtnHandler```: отвечает за привязку обработчика клика на кнопку и выполнение действия, если оно передано в параметре.

## Презентер
Реализуется в файле ```index.ts```

## Служебные классы
### 1. Класс ```ProductApi```
Класс для взаимодействия с API, обеспечивающий методы для получения информации о продуктах и отправки данных о заказах.

**Свойства:**
- ```cdn```: URL для доступа к данным.
- ```id```: хранит идентификатор товара.

**Методы:**
- ```getProductItem```: получает информацию о конкретном продукте по ID.
- ```getProductItems```: получает список всех продуктов.
- ```sendOrder```: отправляет данные о заказе на сервер.

